---
종류: "문헌"
날짜: 2023-08-18
인물_강사: "널널한 개발자"
태그: "프로그래밍,네트워크"
출처: "외워서 끝내는 네트워크 핵심이론-기초"
구분_장소_분류: "인프런"
Alias: "" # 한글/영어
---

### 날짜: 2023-08-17

### 태그: #프로그래밍/네트워크

>[!메모]
> 

### 학습 내용
---
## TCP 연결 종료 과정
- 4-way handshaking![[Pasted image 20230818164158.png]]
	- 특별한 이유가 없다면 client의 행동이 Active하다.
		- 연결을 시도하는 것도 client / 종료하려고 시도하는 것도 client.
		- 일반적인 TCP 연결의 흐름
	1. 클라이언트가 연결을 끊기위해 FIN과 ACK를 보낸다.
		- 서버의 ACK를 기다리는 **FIN_WAIT1 상태로 전환**된다.
	2. 서버는 해당 패킷을 받으면 ACK를 보낸다.![[Pasted image 20230818164715.png]]
	3. 클라이언트가 ACK를 받는다.
		- 서버의 FIN+ACK를 기다리는 **FIN_WAIT2 상태로 전환**된다.
	4. 서버가 FIN + ACK를 보낸다.
		- 보낸 패킷에 대한 ACK를 기다리는 **LAST_ACK 상태로 전환**된다.
	5. 클라이언트가 FIN + ACK를 받으면 **TIME_WAIT 상태**로 전환된다.
		- TIME_WAIT 상태가 의미하는 것. 연결을 끊자고 한 주체가 연결이 최종 완료되기 전에 발생하는 상태이다.
		- 따라서 서버에서 TIME_WAIT이 걸린다면 비정상적 흐름이라고 볼 수 있다.
			- 서버에서 검출 되어서는 안되는 상태.
	1. 클라이언트는 얼마 뒤 소켓을 닫는다.![[Pasted image 20230818165126.png]]
		- 소켓(유한한 자원)이 회수되는 것.

- 서버는 외부연결을 받고 있으며, 수동적으로 연결이 끊기기 때문에 일정시간 동안 소켓 낭비가 일어난다.
	- 낭비가 되고 있는 소켓을 닫기 위해 클라이언트에게 끊어달라는 부탁을 해야한다.
	- 이 부분이 Application 프로토콜에 설계되어있어야 한다.
	- 웹서버의 Application 프로토콜은 HTTP이다.
---
### 생각 (파생된 질문/생각)
- 서버에서 Listen 상태라는 것은 소켓을 열 준비가 되어있다는 것인가 소켓을 열어 놓았다는 것인가?
- 서버에서 연결을 주체적으로 끊으려고 하는 상황은 어떤 상황인가?
### 출 처
- [인프런/외워서 끝내는 네트워크 핵심이론 - 기초 ](https://www.inflearn.com/course/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%ED%95%B5%EC%8B%AC%EC%9D%B4%EB%A1%A0-%EA%B8%B0%EC%B4%88/dashboard)

### 연결 문서: {연결 이유}
- [[네트워크 장애 분류]]: 업그레이드 해야 한다. 서버가 닫으려고 하는 상황이 무엇인지 알아보아야 한다.
- [[Listen상태]]: 알려줘 제발..
