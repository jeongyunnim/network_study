---
종류: "문헌"
날짜: "2023-08-29"
인물_저자: "윤성우"
태그: "프로그래밍,네트워크"
출처: "윤성우의 열혈 TCP IP 소켓 프로그래밍"
구분_장소_분류: ""
Alias: "" # 한글/영어
---

### 날짜: 2023-08-29 20:13
### 태그: #프로그래밍/네트워크

>[!메모]
> 

### 학습 내용
---
## 연결 요청 대기 상태
### listen()
- 이 함수의 호출을 통해 서버는 연결 요청 대기상태로 진입한다.
- 이 함수 호출 이후에 클라이언트가 connect()를 할 수 있다.
- 함수 시그니쳐
```c++
#include <sys/type.h>

int listen(int sock, int backlog;
```
- 반환 값: 성공시 1, 실패시 0
- sock: 연결 요청 대기 상태에 두려는 socket의 파일 디스크립터
	- 이 함수의 인자로 전달된 소켓은 **서버 통신 소켓(리스닝 소켓)**\이 된다. 
- backlog: 연결 요청 대기 큐의 크기
	- 이 인자로 전달된 크기 만큼 클라이언트의 연결 요청을 대기시킬 수 있다.
### 연결 요청 대기 상태
- 클라이언트가 연결 요청을 했을 때 연결이 수락될 때까지 연결 요청 자체를 대기시킬 수 있는 상태.
- == 서버 소켓과 연결요청 대기 큐가 완전히 준비되어서 클라이언트의 연결 요청을 받을 수 있는 상태.
- `listen()`이 호출되면 서버 소켓이 만들어지며 동시에 서버 소켓에 접근할 수 있도록 하는 **연결 요청 대기 큐**가 두 번째 인자만큼 생성이 된다.
- 연결 요청 대기 큐는 웹서버인 경우 최소 15 이상을 전달해야한다.
## 클라이언트의 연결 요청 수락
### accept()
- 클라이언트의 `connect()`와 호응하는 함수.
- 서버 통신 소켓이 만들어지며, 클라이언트 소켓과 연결된다.
- 함수 시그니처
```c++
int accept(int sock, struct sockaddr *addr, socklen_t *addrlen);
```
- 반환 값: 성공 시 생성된 소켓의 파일 디스크립터, 실패시 -1
- sock: 서버 소켓의 파일 디스크립터
- addr: 연결 요청한 클라이언트의 주소 정보를 담을 변수의 주소 값.
- addren: addr에 전달된 주소 변수 크기, 크기 정보를 변수에 저장한 다음 변수의 주소 값을 전달.
	- 크기 정보로 채워져 있던 변수에 클라이언트의 **주소 정보 길이가 바이트로 계산되어 채워**진다.
### 클라이언트의 connect()
- 함수 시그니쳐
```c++
#include <sys/socket.h>

int connect(int sock, const sockaddr *servaddr, sockelen_t addrlen);
```
- 반환 값
	- 서버에 의해 연결요청이 접수되었을 경우: **생성된 소켓의 파일 디스크립터**
	- 네트워크 단절 등 오류가 발생하여 연결 요청의 중단: **-1**
- sock: 클라이언트 소켓의 파일 디스크립터
- servaddr: 연결 요청할 서버 주소 정보를 담을 변수의 주소 값.
	- 인자로 전달된 주소에 클라이언트의 주소 정보가 채워진다.
- addrlen: servaddr에 전달된 주소 변수 크기, 크기 정보를 변수에 저장한 다음 변수의 주소 값을 전달.
	- 클라이언트에서 사용하는 서버의 sockaddr 크기는 고정되어있기 때문에 길이를 직접 넘겨준다. accept에서는 클라이언트가 IPv6을 사용하더라도 통신이 가능하도록 설계되어있음.
---
### 생각 (파생된 질문/생각)
- 
### 출 처
- 윤성우의 열혈 TCP IP 소켓 프로그래밍

### 연결 문서: {연결 이유}
- 